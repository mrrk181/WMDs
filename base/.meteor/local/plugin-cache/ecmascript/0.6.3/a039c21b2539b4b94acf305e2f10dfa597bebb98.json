{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/packages/xolvio:cleaner/cleaner.js","filenameRelative":"/packages/xolvio:cleaner/cleaner.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"polyfill":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/packages/xolvio:cleaner/cleaner.js.map","sourceFileName":"/packages/xolvio:cleaner/cleaner.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"cleaner"},"ignored":false,"code":"if (Meteor.isServer) {\n  (function () {\n    var _resetDatabase = function (options) {\n      if (process.env.NODE_ENV !== 'development') {\n        throw new Error('resetDatabase is not allowed outside of a development mode. ' + 'Aborting.');\n      }\n\n      options = options || {};\n      var excludedCollections = ['system.indexes'];\n\n      if (options.excludedCollections) {\n        excludedCollections = excludedCollections.concat(options.excludedCollections);\n      }\n\n      var db = MongoInternals.defaultRemoteCollectionDriver().mongo.db;\n      var getCollections = Meteor.wrapAsync(db.collections, db);\n      var collections = getCollections();\n\n      var appCollections = _.reject(collections, function (col) {\n        return col.collectionName.indexOf('velocity') === 0 || excludedCollections.indexOf(col.collectionName) !== -1;\n      });\n\n      _.each(appCollections, function (appCollection) {\n        var remove = Meteor.wrapAsync(appCollection.remove, appCollection);\n        remove({});\n      });\n    };\n\n    Meteor.methods({\n      'xolvio:cleaner/resetDatabase': function (options) {\n        _resetDatabase(options);\n      }\n    });\n\n    resetDatabase = function (options, callback) {\n      _resetDatabase(options);\n\n      if (typeof callback === 'function') {\n        callback();\n      }\n    };\n  })();\n}\n\nif (Meteor.isClient) {\n  resetDatabase = function (options, callback) {\n    Meteor.call('xolvio:cleaner/resetDatabase', options, callback);\n  };\n}","ast":null,"map":{"version":3,"sources":["/packages/xolvio:cleaner/cleaner.js"],"names":["Meteor","isServer","_resetDatabase","options","process","env","NODE_ENV","Error","excludedCollections","concat","db","MongoInternals","defaultRemoteCollectionDriver","mongo","getCollections","wrapAsync","collections","appCollections","_","reject","col","collectionName","indexOf","each","appCollection","remove","methods","resetDatabase","callback","isClient","call"],"mappings":"AAAA,IAAIA,OAAOC,QAAX,EAAqB;AAAA;AACnB,QAAMC,iBAAiB,UAAUC,OAAV,EAAmB;AACxC,UAAIC,QAAQC,GAAR,CAAYC,QAAZ,KAAyB,aAA7B,EAA4C;AAC1C,cAAM,IAAIC,KAAJ,CACJ,iEACA,WAFI,CAAN;AAID;;AAEDJ,gBAAUA,WAAW,EAArB;AACA,UAAIK,sBAAsB,CAAC,gBAAD,CAA1B;;AACA,UAAIL,QAAQK,mBAAZ,EAAiC;AAC/BA,8BAAsBA,oBAAoBC,MAApB,CAA2BN,QAAQK,mBAAnC,CAAtB;AACD;;AAED,UAAIE,KAAKC,eAAeC,6BAAf,GAA+CC,KAA/C,CAAqDH,EAA9D;AACA,UAAII,iBAAiBd,OAAOe,SAAP,CAAiBL,GAAGM,WAApB,EAAiCN,EAAjC,CAArB;AACA,UAAIM,cAAcF,gBAAlB;;AACA,UAAIG,iBAAiBC,EAAEC,MAAF,CAASH,WAAT,EAAsB,UAAUI,GAAV,EAAe;AACxD,eAAOA,IAAIC,cAAJ,CAAmBC,OAAnB,CAA2B,UAA3B,MAA2C,CAA3C,IACLd,oBAAoBc,OAApB,CAA4BF,IAAIC,cAAhC,MAAoD,CAAC,CADvD;AAED,OAHoB,CAArB;;AAKAH,QAAEK,IAAF,CAAON,cAAP,EAAuB,UAAUO,aAAV,EAAyB;AAC9C,YAAIC,SAASzB,OAAOe,SAAP,CAAiBS,cAAcC,MAA/B,EAAuCD,aAAvC,CAAb;AACAC,eAAO,EAAP;AACD,OAHD;AAID,KA1BD;;AA4BAzB,WAAO0B,OAAP,CAAe;AACb,sCAAgC,UAAUvB,OAAV,EAAmB;AACjDD,uBAAeC,OAAf;AACD;AAHY,KAAf;;AAMAwB,oBAAgB,UAASxB,OAAT,EAAkByB,QAAlB,EAA4B;AAC1C1B,qBAAeC,OAAf;;AACA,UAAI,OAAOyB,QAAP,KAAoB,UAAxB,EAAoC;AAAEA;AAAa;AACpD,KAHD;AAnCmB;AAwCpB;;AACD,IAAI5B,OAAO6B,QAAX,EAAqB;AACnBF,kBAAgB,UAASxB,OAAT,EAAkByB,QAAlB,EAA4B;AAC1C5B,WAAO8B,IAAP,CAAY,8BAAZ,EAA4C3B,OAA5C,EAAqDyB,QAArD;AACD,GAFD;AAGD","file":"/packages/xolvio:cleaner/cleaner.js.map","sourcesContent":["if (Meteor.isServer) {\n  const _resetDatabase = function (options) {\n    if (process.env.NODE_ENV !== 'development') {\n      throw new Error(\n        'resetDatabase is not allowed outside of a development mode. ' +\n        'Aborting.'\n      );\n    }\n\n    options = options || {};\n    var excludedCollections = ['system.indexes'];\n    if (options.excludedCollections) {\n      excludedCollections = excludedCollections.concat(options.excludedCollections);\n    }\n\n    var db = MongoInternals.defaultRemoteCollectionDriver().mongo.db;\n    var getCollections = Meteor.wrapAsync(db.collections, db);\n    var collections = getCollections();\n    var appCollections = _.reject(collections, function (col) {\n      return col.collectionName.indexOf('velocity') === 0 ||\n        excludedCollections.indexOf(col.collectionName) !== -1;\n    });\n\n    _.each(appCollections, function (appCollection) {\n      var remove = Meteor.wrapAsync(appCollection.remove, appCollection);\n      remove({});\n    });\n  };\n\n  Meteor.methods({\n    'xolvio:cleaner/resetDatabase': function (options) {\n      _resetDatabase(options);\n    }\n  });\n\n  resetDatabase = function(options, callback) {\n    _resetDatabase(options);\n    if (typeof callback === 'function') { callback(); }\n  }\n\n}\nif (Meteor.isClient) {\n  resetDatabase = function(options, callback) {\n    Meteor.call('xolvio:cleaner/resetDatabase', options, callback);\n  }\n}\n"]},"hash":"a039c21b2539b4b94acf305e2f10dfa597bebb98"}
